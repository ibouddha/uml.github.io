<!DOCTYPE html>
<html>
<head>
    <title>Task Manager</title>
    <link rel="stylesheet" href="{{url_for('static',filename='css/style.css')}}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <div class="nav">
        <div class="logo"><img src="" alt=""></div>
        <div class="profile">
            <ul>
                <li><a href="/all">Voir tout</a></li>
                <li>{{session['username']}}</li>
                <li><a href="/logout">Logout</a></li>
            </ul>
        </div>
    </div>
    <div class="main">
        <h1>Task Manager</h1>

        <form id="add-task-form" method="POST" action="/add-task">
            <input type="text" id="titre" name="titre" placeholder="Title" required>
            <input type="text" id="description" name="description" placeholder="Description" required>
            <input type="text" name="state" id="state" value="pending">
            <button type="submit">Add Task</button>
        </form>

        <div id="task-list">
            <table class="col ">
                <thead>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Status</th>
                    <th>Actions</th>
                </thead>
                <tbody>
                    {% for task in tasks %}
                    <tr>
                        <td contenteditable>{{task[1]}}</td>
                        <td contenteditable>{{task[2]}}</td>
                        <td contenteditable class="etat">{{task[3]}}</td>
                        <td>
                            <a href="/complete/{{task[0]}}"><button class="menu"><img src="{{url_for('static',filename='icon/valid.png')}}"></button></a>
                            <a href="/delete/{{task[0]}}"><button class="menu"><img src="{{url_for('static',filename='icon/deny.png')}}"></button></a>
                            <!-- <a href="/"><button type="menu">terminer</button></a> -->
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- <script>
        $(document).ready(function() {
            $.get("/", function(data) {
                let tasks = data.tasks;
                for (let i = 0; i < tasks.length; i++) {
                    let task = tasks[i];
                    $("#task-list").append(`
                        <div id="task-${task.idtask}">
                            <h2>${task.titre}</h2>
                            <p>${task.description}</p>
                            <p>Status: ${task.state}</p>
                            <button onclick="deleteTask(${task.idtask})">Delete</button>
                            <button onclick="completeTask(${task.idtask})">Complete</button>
                        </div>
                    `);
                }
            });

            $("#add-task-form").submit(function(e) {
                e.preventDefault();
                let title = $("#titre").val();
                let description = $("#description").val();
                let state = $("#state").val();
                $.post("/add-task", { titre: title, description: description, state: state }, function() {
                    location.reload();
                });
            });
        });

        $(".etat").onchange(function(e){
            
        });

        function deleteTask(taskId) {
            $.get(`/delete/${taskId}`, function() {
                $(`#task-${taskId}`).remove();
            });
        }

        function update(taskId){
            $.get(`/update/${taskId}`, function(data) {
                let task = data.task;
                $("#titre").val(task.titre);
                $("#description").val(task.description);
                $("#state").val(task.state);
                });
        }

        function completeTask(taskId) {
            $.get(`/complete/${taskId}`, function() {
                location.reload();
            }); 
        }

        
    </script>-->
</body>
</html>
